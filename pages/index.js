import Head from 'next/head';

import { 
    Navbar, 
    NavigationDots, 
    Hero, 
    About, 
    Technologies, 
    Projects, 
    Contact 
} from '../components';

import { 
    getHeroes,
    getProjects, 
    getTechnologies, 
    getAbouts,
    useCurrentSection,
} from '../lib';

export default function Home({ heroes, projects, technologies, abouts }) {
    const { 
        currentSection,
        aboutRef,
        technologiesRef,
        projectsRef,
        heroRef,
        contactRef,
        onChangeCurrentSection,
    } = useCurrentSection();

    return (
        <>
            <Head>
                <title>Serey Roth&apos; Portfolio</title>
                <meta name="description" content="Generated by create next app" />
                <meta name="viewport" content="width=device-width, initial-scale=1" />
                <link rel="icon" href="/favicon.ico" />
            </Head>
            <main className='w-screen min-h-screen flex flex-col items-center
            bg-gradient-to-b from-indigo-500/20 dark:bg-black dark:text-gray-200'>
                <Navbar />

                <div className='fixed top-1/2 right-0 md:right-2
                lg:right-4 z-[5] -translate-y-1/2'>
                    <NavigationDots
                        currentSectionIndex={currentSection}
                        onClick={onChangeCurrentSection} />
                </div>

                <Hero hero={heroes[0]} ref={heroRef}/>

                <About 
                    ref={aboutRef} 
                    abouts={abouts} />

                <Projects 
                    ref={projectsRef} 
                    projects={projects} />

                <Technologies 
                    ref={technologiesRef} 
                    technologies={technologies} />

                <Contact ref={contactRef} />
            </main>
        </>
    )
};

export async function getServerSideProps() {
    const heroes = await getHeroes();
    const projects = await getProjects();
    const technologies = await getTechnologies();
    const abouts = await getAbouts();
    
    return {
        props: {
            heroes,
            projects,
            technologies,
            abouts,
        }
    }
};
