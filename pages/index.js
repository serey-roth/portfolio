import Head from 'next/head'

import About from '../components/About'
import Footer from '../components/Footer'
import Header from '../components/Header'
import Navbar from '../components/Navbar'
import NavigationDots from '../components/NavigationDots'
import Projects from '../components/Projects'
import Technologies from '../components/Technologies'

import { client } from '../lib/client'

export default function Home({ projects, technologies, abouts }) {
    return (
        <>
            <Head>
                <title>Serey Roth&apos; Portfolio</title>
                <meta name="description" content="Generated by create next app" />
                <meta name="viewport" content="width=device-width, initial-scale=1" />
                <link rel="icon" href="/favicon.ico" />
            </Head>
            <main className='w-screen min-h-screen flex flex-col items-center
            bg-gradient-to-b from-indigo-500/20'>
                <Navbar />
                <div className='fixed top-1/2 right-5 z-[5] -translate-y-1/2'>
                    <NavigationDots />
                </div>
                <Header />
                <About abouts={abouts} />
                <Technologies technologies={technologies} />
                <Projects projects={projects} />
                <Footer />
            </main>
        </>
    )
}

export async function getServerSideProps() {
    const projectQuery = `*[_type == 'project']{ 
        ...,
        "tools":tools[]->{name, icon} 
    }`;
    const toolQuery = `*[_type == "tool"]`;
    const aboutQuery = `*[_type == "about"]`;
    
    const projects = await client.fetch(projectQuery);
    const technologies = await client.fetch(toolQuery);
    const abouts = await client.fetch(aboutQuery);

    return {
        props: {
            projects,
            technologies,
            abouts,
        }
    }
}
